<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bundestag pie chart • practicalgg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bundestag pie chart">
<meta property="og:description" content="practicalgg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">practicalgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Texas_income.html">Median Texas income by county</a>
    </li>
    <li>
      <a href="../articles/Winkel_tripel.html">Winkel tripel projection</a>
    </li>
    <li>
      <a href="../articles/bundestag_pie.html">Bundestag pie chart</a>
    </li>
    <li>
      <a href="../articles/corruption_human_development.html">Corruption and human development</a>
    </li>
    <li>
      <a href="../articles/goode.html">Interrupted Goode homolosine</a>
    </li>
    <li>
      <a href="../articles/health_status.html">Health status by age</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wilkelab/practicalgg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bundestag_pie_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bundestag pie chart</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wilkelab/practicalgg/blob/master/vignettes/bundestag_pie.Rmd"><code>vignettes/bundestag_pie.Rmd</code></a></small>
      <div class="hidden name"><code>bundestag_pie.Rmd</code></div>

    </div>

    
    
<p>For this example, we will use the following packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggforce.data-imaginist.com">ggforce</a></span><span class="op">)</span>   <span class="co"># for geom_arc_bar()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span>   <span class="co"># for theme_map()</span></code></pre></div>
<p>The dataset is provided as <code><a href="../reference/bundestag.html">practicalgg::bundestag</a></code>. Let’s look at it in table form and as a basic pie-chart.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="va">bundestag</span> <span class="op">&lt;-</span> <span class="fu">practicalgg</span><span class="fu">::</span><span class="va"><a href="../reference/bundestag.html">bundestag</a></span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">party</span>, <span class="va">seats</span>, <span class="va">colors</span><span class="op">)</span>

<span class="va">bundestag</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   party   seats colors 
##   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;  
## 1 CDU/CSU   243 #4E4E4E
## 2 SPD       214 #B6494A
## 3 FDP        39 #E7D739</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">bundestag</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">seats</span>, fill <span class="op">=</span> <span class="va">party</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_polar</span><span class="op">(</span>theta <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></code></pre></div>
<p><img src="bundestag_pie_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<p>We could try to style this pie chart to make it look the way we want, but I usually find it easier to draw pie charts in cartesian coordinates, using <code><a href="https://ggforce.data-imaginist.com/reference/geom_arc_bar.html">geom_arc_bar()</a></code> from ggforce. This requires a little more data preparation up front but gives much more predictable results on the back end.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bund_pie</span> <span class="op">&lt;-</span> <span class="va">bundestag</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">seats</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    end_angle <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">seats</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">seats</span><span class="op">)</span>,   <span class="co"># ending angle for each pie slice</span>
    start_angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">end_angle</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,   <span class="co"># starting angle for each pie slice</span>
    mid_angle <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="va">start_angle</span> <span class="op">+</span> <span class="va">end_angle</span><span class="op">)</span>,   <span class="co"># middle of each pie slice, for the text label</span>
    <span class="co"># horizontal and vertical justifications depend on whether we're to the left/right</span>
    <span class="co"># or top/bottom of the pie</span>
    hjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mid_angle</span> <span class="op">&gt;</span> <span class="va">pi</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,
    vjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mid_angle</span> <span class="op">&lt;</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span> <span class="op">|</span> <span class="va">mid_angle</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">bund_pie</span></code></pre></div>
<pre><code>## # A tibble: 3 x 8
##   party   seats colors  end_angle start_angle mid_angle hjust vjust
##   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 FDP        39 #E7D739     0.494       0         0.247     0     0
## 2 SPD       214 #B6494A     3.20        0.494     1.85      0     1
## 3 CDU/CSU   243 #4E4E4E     6.28        3.20      4.74      1     0</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># radius of the pie and radius for outside and inside labels</span>
<span class="va">rpie</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">rlabel_out</span> <span class="op">&lt;-</span> <span class="fl">1.05</span> <span class="op">*</span> <span class="va">rpie</span>
<span class="va">rlabel_in</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">rpie</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">bund_pie</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_arc_bar.html">geom_arc_bar</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, r0 <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="va">rpie</span>,
      start <span class="op">=</span> <span class="va">start_angle</span>, end <span class="op">=</span> <span class="va">end_angle</span>, fill <span class="op">=</span> <span class="va">party</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="bundestag_pie_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<p>Next we add labels representing the numbers of seats for each party.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">bund_pie</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_arc_bar.html">geom_arc_bar</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, r0 <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="va">rpie</span>,
      start <span class="op">=</span> <span class="va">start_angle</span>, end <span class="op">=</span> <span class="va">end_angle</span>, fill <span class="op">=</span> <span class="va">party</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">seats</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span> <span class="co"># use 14 pt font size</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="bundestag_pie_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>And we provide labels for the parties outside of the pie.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">bund_pie</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_arc_bar.html">geom_arc_bar</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, r0 <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="va">rpie</span>,
      start <span class="op">=</span> <span class="va">start_angle</span>, end <span class="op">=</span> <span class="va">end_angle</span>, fill <span class="op">=</span> <span class="va">party</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">seats</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">party</span>,
      hjust <span class="op">=</span> <span class="va">hjust</span>, vjust <span class="op">=</span> <span class="va">vjust</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="bundestag_pie_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>We see that we need to make some space for the outside labels. We can do that by manually setting the scale limits and expansion.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">bund_pie</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_arc_bar.html">geom_arc_bar</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, r0 <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="va">rpie</span>,
      start <span class="op">=</span> <span class="va">start_angle</span>, end <span class="op">=</span> <span class="va">end_angle</span>, fill <span class="op">=</span> <span class="va">party</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">seats</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">party</span>,
      hjust <span class="op">=</span> <span class="va">hjust</span>, vjust <span class="op">=</span> <span class="va">vjust</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="cn">NULL</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.4</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="cn">NULL</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.05</span>, <span class="fl">1.15</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="bundestag_pie_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>This plot shows how using a cartesian coordinate system is helpful. We can see exactly where elements lie and how we need to expand the limits to fully show all the labels. The CDU/CSU label remains partially obscured at this point, but this will be fixed later as we remove the legend and axis labels, resulting in slightly more space for the pie chart itself as well as the labels.</p>
<p>Next we change the pie colors. The dataset provides appropriate party colors, and we use those directly with <code>scale_fill_identity()</code>. Note that this scale eliminates the legend. We don’t need a legend anyways, because we have direct labeled the pie slices.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">bund_pie</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_arc_bar.html">geom_arc_bar</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, r0 <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="va">rpie</span>,
      start <span class="op">=</span> <span class="va">start_angle</span>, end <span class="op">=</span> <span class="va">end_angle</span>, fill <span class="op">=</span> <span class="va">colors</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">seats</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">party</span>,
      hjust <span class="op">=</span> <span class="va">hjust</span>, vjust <span class="op">=</span> <span class="va">vjust</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="cn">NULL</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.4</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="cn">NULL</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.05</span>, <span class="fl">1.15</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_identity</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="bundestag_pie_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>The black color for the text labels doesn’t work well on top of the dark fill colors, and the black outline also looks overbearing, so we’ll change those colors to white.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">bund_pie</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_arc_bar.html">geom_arc_bar</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, r0 <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="va">rpie</span>,
      start <span class="op">=</span> <span class="va">start_angle</span>, end <span class="op">=</span> <span class="va">end_angle</span>, fill <span class="op">=</span> <span class="va">colors</span>
    <span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"white"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">seats</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>,
    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"white"</span>, <span class="st">"white"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">party</span>,
      hjust <span class="op">=</span> <span class="va">hjust</span>, vjust <span class="op">=</span> <span class="va">vjust</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="cn">NULL</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.4</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="cn">NULL</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.05</span>, <span class="fl">1.15</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_identity</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="bundestag_pie_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p>Finally, we need to apply a theme that removes the background grid and axes</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">bund_pie</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_arc_bar.html">geom_arc_bar</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, r0 <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="va">rpie</span>,
      start <span class="op">=</span> <span class="va">start_angle</span>, end <span class="op">=</span> <span class="va">end_angle</span>, fill <span class="op">=</span> <span class="va">colors</span>
    <span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"white"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_in</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">seats</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>,
    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"white"</span>, <span class="st">"white"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="va">rlabel_out</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">mid_angle</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="va">party</span>,
      hjust <span class="op">=</span> <span class="va">hjust</span>, vjust <span class="op">=</span> <span class="va">vjust</span>
    <span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">14</span><span class="op">/</span><span class="va">.pt</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="cn">NULL</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.4</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>
    name <span class="op">=</span> <span class="cn">NULL</span>,
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.05</span>, <span class="fl">1.15</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_identity</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_map.html">theme_map</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="bundestag_pie_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Claus O. Wilke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
